## 第一章	操作系统的概述

1、操作系统的特征

并发、共享、虚拟、异步

2、操作系统的发展

（1）手工操作阶段

（2）批处理阶段（操作系统开始出现）包括：单道批处理系统、多道批处理系统

（3）分时操作系统

分时操作系统就是把处理器运行时间分成很短的时间片，按时间片轮流把处理器分配给各联机作业使用。特征：同时性、交互性、独立性、及时性。

（4）实时操作系统

就是指能在某个时间限制内完成某些紧急任务而不需要时间片排队。

（5）网络操作系统和分布式计算机系统

（6）个人计算机操作系统

## 第二章、进程管理

### 1、进程与线程

#### （1）进程

进程是内存中运行的应用程序，具有一定独立功能的程序在某个数据集上一次运行，是操作系统分配和调度的一个独立单位。我们还可以从操作系统的角度看，进程分为系统进程和用户进程，系统进程主要负责执行操作系统的程序，用户进程主要负责执行用户程序。
#### （2）程序和进程的关系
程序就是构成进程的组成部分之一，如果没有程序，那么进程就没有存在的意义，程序是静态的，而进程是动态的，是有生命周期的。进程是程序的一个执行过程，就是为了程序的一次执行而暂时存在。
#### （3）线程
线程只是进程的一个小的执行单位，是处理器任务调度和执行的基本单位。

#### （4）进程的5种状态

1、创建态
进程创建首先是系统为它创建一个PCB（进程控制块），PCB通常包含：进程标识复发、用户标志符、当前状态、优先级、代码段、数据段以及各种寄存器值等等，在进程结束就删除。创建成功的话则分配必要的内存空间，最后把该进程转入就绪态。

2、就绪态
此时进程已经获取一定的资源具有运行条件，但是由于没有获得处理器而只等待获取时间片就立即运行状态。

3、运行态
是指进程已获取处理器并且正在处理器上运行状态。

4、阻塞态（waiting等待状态）
是指进程因等待某种事件发生而暂时不能运行的状态，可能由于运行时间片用完或请求系统资源失败以及等待某种操作的完成等等某种原因从运行态转到阻塞态。

5、结束态

#### （5）进程转换
1 就绪—>运行：就绪状态是已经具备运行的能力啦，但是由于未能获得到处理器暂时不能运行。此时等待进程调度算法把处理器分配给某个就绪进程，这样建立进程运行状态标记，并把控制转入进程的启动程序。

2 运行—>就绪：运行到就绪是指正在运行的进程，由于规定运行时间片用完而使系统发出超时中断请求，超时中断请求是处理程序把该进程的状态修改为就绪状态。

3 运行—>阻塞：正在运行进程除了受时间限制外，还有其他各种因素影响。比如运行中进程需要等待文件的输入时，控制便自动转入系统控制程序，通过信息管理程序进行文件输入，但是在输入的过程中这个进程并不会恢复到运行状态，而是从运行状态变成阻塞状态。

4 阻塞—>就绪：阻塞的进程获得解除后，并不会立即进入运行，而是根据其自身特征插入适当位置的就绪状态。

#### （6）七状态进程模型
挂起：是指把进程从内存转到内存外
#### （7）进程的通信

1 共享存储
在进程间通信的时候，系统会分配一块共享空间，通过共享空间进行读写操作实现进程之间信息交换。然后在共享空间进行读写操作时，需要使用**同步互斥工具**（比如PV操作）对共享空间的读写操作进行控制。共享存储还可以分为两种：一种是基于存储区的共享，另一种基于数据结构共享的。（这种方式存在进程竞争问题，使用信号量解决，下面讲解）。

2 管道通信
数据是以字符流的形式大量写入管道，为了协调双方的通信，管道机制还必须提供：互斥、同步、确定对方的存在的这样的能力。管道是采用**半双工通信**的，就是在一时刻只能单向传输，若要实现双向传输需要建立两个管道。

3 消息传递
消息传递进程间的数据交换是以格式化的消息为单位的。也分为两种方式：
第一种：直接方式。发送进程直接把消息发送给接收进程，并将它挂在接收进行的消息缓冲队列，然后接收进程从消息缓冲队列获取消息。
第二种：间接方式。就是发送进程把消息发到某个中间实体，然后接收进程去中间实体取得消息。（类似学校的投诉信箱一样）

4 信号量
信号量是计数器，是一种实现进程之间的**互斥和同步**的问题。碧如，信号量初始值是1，假设A进程来访问内存1时，此时将信号量的值修改为0，然后再有B进程也来访问内存1，此时看到信号量值为0就知道已经有其他进程在访问内存1啦。（不知道大家有没有发现，类似坐高铁上厕所，当有人上厕所时锁门外人会看到红色还是1这样的，此时你就只能等待里面的人上完）

#### （8）程序是如何执行的？

执行过程：[源码]——>[.exe]——->[内存：PCB]——->[CPU]

CPU从内存读取出指令，此时cpu会设置

PSW：程序状态寄存器

PC：程序计数器，用于存放下一条要执行的指令系统

IR：指令寄存器，存放当前正在执行的指令

通用寄存器：存放其他一些必要的信息

CPU正在执行指令1，此时CPU会把指令1存放到IR（指令寄存器），然后还会把接下来要执行的指令2存放到PC（程序计数器），直到运行结束为此。

### 二、处理机调度
#### 调度算法
1、先来先服务调度算法

该算法是按照作业进程到达的先后顺序进行服务的（类似食堂排队打饭的例子，主要是从公平的角度去出发）。都用于作业调度和进程调度，当不能作为分时系统和实时系统的主要策略，因为它是属于**非抢占方式算法**。优缺点：公平简单，但是效率很低，有时候需要长时间作业排在短作业前面，此时对短作业是不利的；有利于CPU繁忙作业，但不利于I/O繁忙作业。不会导致饥饿。

2、短作业优先调度算法
是指让要求服务时间最短的作业/进程优先得到服务。作业调度和进程调度都是用于的，这样可能会出现长作业长期不被调用，所以会出现饥饿现象。默认非抢占式的。

3、高响应比优先调度算法
该算法是综合考虑作业/进程的等待时间和要求服务时间，在每次调度时先计算各个作业/进程的响应比，从中选择响应最高的作业先运行。响应比=（等待时间+要求服务时间）/要求服务时间，都可以适用于作业调度和进程调度。是属于非抢占式的，不会出现饥饿现象。

4、时间片轮转调度算法

5、优先级调度算法

6、多级反馈队列调度算法

### 三、进程同步

#### 1、进程同步基本概念

在多道程序环境下，进程是并发执行的，不同进程之间存在着不同的相互制约关系。为了协调进程之间的相互制约关系，引入了进程同步的概念。

（1）临界资源

概念：共享系统中各种资源一次只允许一个进程使用的资源，称为临界资源。为了保证临界资源的正确使用，临界资源的访问过程分为：进入区、临界区、退出区、剩余区

（2）同步

同步是指为了某种任务进程间相互协调。举个例子：

（3）互斥

互斥就是当一个进行进入临界区使用临界资源时，另一个进程必须等待已经占有临界资源的进行退出临界区后，另一个进程才可以去访问。

#### 2、实现临界资源互斥的方法

（1）软件实现方法

单标志法、双标志法先检查、双标志法后检查、Peterson is Algorithm

（2）硬件实现方法

中断屏蔽方法、硬件指令方法

#### 3、信号量

信号量机构是一种功能较强的机制，可用来解决互斥与同步的问题，它只能被两个标准的原语wait(S)和signal(S)来访问，也可以记为“P操作”（通过）和“V操作（释放）”。原语是指完成某种功能且不被分割不被中断执行的操作序列，通常可由硬件来实现完成不被分割执行特性的功能。

#### 4、管程

管程也是实现进程同步工具。

#### 5、典型同步问题

（1）生产者-消费者问题

（2）读者-写者问题

（3）哲学家进餐问题

（4）吸烟者问题

### 四、死锁

1、死锁概念

死锁是指多个进程因竞争资源而造成的一种僵局（相互等待），如果没有外来作用这些进行将无法向前推进。

2、产生死锁的原因

（1）系统资源的竞争

（2）进程推测顺序非法

3、死锁产生必要条件

（1）互斥条件

（2）不剥夺条件

（3）请求并保持条件

（4）循环等待条件

4、死锁处理策略

（1）死锁预防

破坏死锁产生的4个必要条件即可

（2）避免死锁

1）系统安全状态

2）银行家算法

（3）死锁的检测及解除

## 第三章	内存管理

1、虚拟机内存技术的实现

虚拟机内存实现需要建立在离散分配的内存管理方式的基础上，实现有三种方式：请求分页存储管理、请求分段存储管理和请求段页式存储管理。

1.1	分页管理方式

（1）页表机制

（2）缺页中断机构

在请求分页系统中，每当所要访问的页面不存在内存中时，便产生一个缺页中断，请求操作系统将所缺的页调入内存。

（3）地址变换机构

请求分页系统中的地址变换机构，是在分页系统地址机构的基础上，为实现虚拟机内存，由添加了某些功能而形成的。

* 找到页表项需要检查页面是否在内存中
* 若页面不在内存中，需要请求调页
* 若内存空间不足，还需要换出页面
* 页面调入内存后，需要修改相应页表面



1.2	页面置算法

（1）最佳（OPT）置换算法

就是选择的被淘汰页面是以后不使用的页面或者在最长时间内不再被访问的页面，以便保证获得最低的缺页率。

（2）先进先出（FIFO）页面置换算法

先淘汰最早进入内存页面，即在内存中驻留时间最长的页面。（实现简单但性能差）

（3）最近最久未使用（LRU）置换算法

淘汰最近最长时间未访问过的页面，该算法认为过去一段时间未访问过的页面，在最近的将来可能也不会被访问。该算法为每个页面设置一个访问字段，用来记录页面自上次被访问以来所经历的时间，淘汰页面时选择现有页面中值最大的予以淘汰。（实现比较困难且开销大）

（4）时钟（CLOCK）置换算法

* 简单的时钟算法
* 改进型时钟算法



## 第四章	文件管理

1、内存如何读取磁盘？

通过页表找到内存信息，如果页面不存在内存中，会触发一个缺页中断请求操作系统将缺的页调入内存中。此时如果内存有空闲块就直接分配一块装调入即可，如果内存没有空闲块，操作系统就通过页面置换算法淘汰某一页，然后在装入内存。页面置换算法有：最佳置换算法、先进先出置换算法、最近最久未使用置换算法、时钟置换算法。
