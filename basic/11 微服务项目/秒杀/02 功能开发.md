### 功能开发前期准备工作

1、我们先做页面跳转。登录功能，在controller层新建一个`LoginController`类。

```java
/**
 * 登录
 * @Slf4j 用来输出日志的，你可以不使用
 */
@RestController
@RequestMapping("/login")
@Slf4j
public class LoginController {
    /**
     * 功能描述：跳转登录页面
     * @return
     */
    @RequestMapping("toLogin")
    public String toLogin() {
        return "login";
    }
}
```

2、在resource目录下，写一个login登录页面

```html
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>登录</title>
    <!--jquery-->
    <script type="text/javascript" th:src="@{/js/jquery.min.js}"></script>
    <!-- bootstrap -->
    <link rel="stylesheet" type="text/css" th:href="@{/bootstrap/css/bootstrap.min.css}" />
    <script type="text/javascript" th:src="@{/bootstrap/js/bootstrap.min.js}"></script>
    <!-- jquery-validator-->
    <script type="text/javascript" th:src="@{/jquery-validation/jquery.validate.min.js}"></script>
    <script type="text/javascript" th:src="@{/jquery-validation/localization/messages_zh.min.js}"></script>
    <!-- layer -->
    <script type="text/javascript" th:src="@{/layer/layer.min.js}"></script>
    <!-- MD5.js -->
    <script type="text/javascript" th:src="@{/js/md5.min.js}"></script>
    <!-- common.js -->
    <script type="text/javascript" th:src="@{/js/common.js}"></script>
</head>
<body>
<form name="loginForm" id="loginForm" method="post" style="width: 50%; margin: 0 auto">
    <h2 style="text-align: center;margin-bottom: 20px">登录</h2>
    <div class="form-group">
        <div class="row">
            <label class="form-label col-md-4">请输入手机号码</label>
            <div class="col-lg-5">
                <input id="mobile" name="mobile" class="form-control" type="text" placeholder="手机号码" required="true" minlength="11" maxlength="11"/>
            </div>
            <div class="col-md-1"></div>
        </div>
    </div>
    <!-- 密码 -->
    <div class="form-group">
        <div class="row">
            <label class="form-label col-md-4">请输入密码</label>
            <div class="col-lg-5">
                <input id="password" name="password" class="form-control" type="password" placeholder="密码" required="true" minlength="8" maxlength="16"/>
            </div>
            <div class="col-md-1"></div>
        </div>
    </div>

    <!-- 重置 -->
    <div class="row">
        <div class="col-lg-5">
            <button class="bnt btn-primary btn-block" type="reset" onclick="reset()">重置</button>
        </div>
        <div class="col-lg-5">
            <button class="bnt btn-primary btn-block" type="submit" onclick="login()">登录</button>
        </div>
    </div>
</form>
</body>
<script>
    function login() {
        $("#loginForm").validate({
            submitHandler: function (form) {
                doLogin();
            }
        });
    }
    function doLogin() {
        g_showLoading();
        var inputPass = $("#password").val();
        var salt = g_passsword_salt;
        var str = "" + salt.charAt(0) + salt.charAt(3) + inputPass + salt.charAt(5) + salt.charAt(6);
        var password = md5(str);

        $.ajax({
            url: "/login/doLogin",
            type: "POST",
            data: {
                mobile: $("#mobile").val(),
                password: password
            },
            success: function(data) {
                layer.closeAll();
                if (data.code == 200) {
                    layer.msg("成功");
                } else {
                    layer.msg(data.message);
                }
            },
            error: function() {
                layer.closeAll();
            }
        });
    }
</script>
</html>
```

3、实现doLogin方法

（1）在contrller层实现，也是在`LoginController`中实现。

```java
```

（2）在新建一个包和contrller平级vo，vo包主要编写我们的公共返回信息的，新建两个类`RespBean 和 RespBeanEunum`。

**RespBean 类**

```java
/**
 * 公共返回对象
 */
@Data
@NoArgsConstructor
@AllArgsConstructor
public class RespBean {
    private long code; // 状态码
    private String message; //对应消息
    private Object obj; // 有时候返回需要带一个对象
    
    // 成功返回结果
    public static RespBean success() {
        return new RespBean(RespBeanEnum.SUCCESS.getCode(), RespBean.success().getMessage(),null);
    }
    public static RespBean success(Object obj) {
        return new RespBean(RespBeanEnum.SUCCESS.getCode(), RespBean.success().getMessage(),obj);
    }
    
    // 错误返回结果,方法可以直接传入RespBeanEnum类
    public static RespBean error(RespBeanEnum respBeanEnum) {
        return new RespBean(respBeanEnum.getCode(), respBeanEnum.getMessage(), null);
    }
    public static RespBean error(RespBeanEnum respBeanEnum,Object obj) {
        return new RespBean(respBeanEnum.getCode(), respBeanEnum.getMessage(), obj);
    }

}

```



**RespBeanEnum 类**，是个枚举类，主要写一些状态

```java
/**
 * 公共返回对象枚举
 */
@Getter
@ToString
@AllArgsConstructor
public enum RespBeanEnum {
    SUCCESS(200,"SUCCESS"),
    ERROR(500,"服务端异常");
    //状态码
    private final Integer code;
    //相应信息
    private final String message;
}
```



### 开发登录功能

登录功能：点击“登录” —》 调用“login()”方法(执行doLogin()之前还做一层较验) ,doLogin方法如下：

```
function doLogin() {
        g_showLoading();
        var inputPass = $("#password").val();
        var salt = g_passsword_salt;
        var str = "" + salt.charAt(0) + salt.charAt(2) + inputPass + salt.charAt(5) + salt.charAt(4);
        var password = md5(str);
        //通过ajax调用后端接口
        $.ajax({
            url: "/login/doLogin",
            type: "POST",
            data: {
                mobile: $("#mobile").val(),
                password: password
            },
            success: function(data) {
                layer.closeAll();
                if (data.code == 200) {
                    layer.msg("成功");
                } else {
                    layer.msg(data.message);
                }
            },
            error: function() {
                layer.closeAll();
            }
        });
```

前端调试快捷键：`command+option+i`，前端400

该提示只能在控制台提示，为什么不在页面显示？

```html
{"timestamp":"2021-10-01T16:19:04.189+00:00","status":400,"error":"Bad Request","path":"/login/doLogin"}
```

此时，我们应该将该错误收集，然后返回页面。也就是“异常处理”

SpringBoot的全局异常处理有两种：第一种使用ConstraintValidator，只能处理控制器的异常；可以处理所有异常包括没有进入控制器
